<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8"/>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/105/three.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/three@0.101.1/examples/js/controls/OrbitControls.js"></script>
  <script>
    // ページの読み込みを待つ
    window.addEventListener('load', init);

    function init() {

      // サイズを指定
      let width = window.innerWidth;
      let height = window.innerHeight;

      // マウス座標
      let mouse = THREE.Vector2(0, 0);

      // レンダラーを作成
      const renderer = new THREE.WebGLRenderer({
        canvas: document.querySelector('#myCanvas')
      });
      renderer.setPixelRatio(window.devicePixelRatio);
      renderer.setSize(width, height);
      // renderer.setClearColor(0xF5F5F5, 1);

      // シーンを作成
      const scene = new THREE.Scene();
      scene.background = new THREE.Color( 0xcccccc );
      scene.fog = new THREE.FogExp2( 0xcccccc, 0.002 );


      // カメラを作成 (視野角, 画面のアスペクト比, カメラに映る最短距離, カメラに映る最遠距離)
      const camera = new THREE.PerspectiveCamera(45, width / height, 1, 1000);
      camera.position.set(0, 0, 30);

      const controls = new THREE.OrbitControls(camera);
      controls.enableDamping = true; // an animation loop is required when either damping or auto-rotation are enabled
      //controls.dampingFactor = 0.05;
      controls.screenSpacePanning = false;
      controls.minDistance = 1;
			controls.maxDistance = 800;
      controls.maxPolarAngle = Math.PI / 1.4;


      // 箱を作成
      var geometry = new THREE.CylinderBufferGeometry( 0, 10, 30, 4, 1 );
			var material = new THREE.MeshPhongMaterial( { color: 0xffffff, flatShading: true } );
      for ( var i = 0; i < 500; i ++ ) {
        var mesh = new THREE.Mesh( geometry, material );
        mesh.position.x = Math.random() * 1600 - 800;
        mesh.position.y = 0;
        mesh.position.z = Math.random() * 1600 - 800;
        mesh.updateMatrix();
        mesh.matrixAutoUpdate = false;
        scene.add( mesh );

      }

      // lights

      var light = new THREE.DirectionalLight( 0xffffff );
      light.position.set( 1, 1, 1 );
      scene.add( light );

      var light = new THREE.DirectionalLight( 0x002288 );
      light.position.set( - 1, - 1, - 1 );
      scene.add( light );

      var light = new THREE.AmbientLight( 0x222222 );
			scene.add( light );
      

      tick();

      // 毎フレーム時に実行されるループイベントです
      function tick() {
        //box.rotation.y += 0.01;
        renderer.render(scene, camera); // レンダリング

        requestAnimationFrame(tick);
      }

      function onWindowResize() {

				camera.aspect = window.innerWidth / window.innerHeight;
				camera.updateProjectionMatrix();

				renderer.setSize( window.innerWidth, window.innerHeight );

			}
    }
  </script>
  <style>
    body { margin: 0;}
  </style>
</head>
<body>
  <canvas id="myCanvas"></canvas>
</body>
</html>